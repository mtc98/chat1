# Do2 專案完整測試計畫

## 測試環境準備

### 已建立的測試帳號：
- **帳號 1**: mtc@123.com / 123456 (大明)
- **帳號 2**: test@123.com / 123456 (小華)
- **帳號 3**: 123@123.com / 123456 (阿強)

### 已建立的測試專案：
- 電商平台開發 (development)
- 品牌視覺設計 (design)
- 數位行銷活動 (marketing)

---

## 測試項目

### 1️⃣ 註冊新使用者測試

**目的**: 測試新用戶註冊功能是否完整

#### 測試步驟：
1. 開啟應用程式
2. 點擊 "Sign up" 或前往註冊頁面
3. 填寫資料：
   - Email: `newuser@test.com`
   - Password: `123456`
   - Display Name: `測試小新`
   - Profile Thumbnail: 上傳一張圖片 (< 100kb)
4. 點擊 "Sign up"

#### 預期結果：
- ✅ 註冊成功，自動登入
- ✅ 導向到 Dashboard 頁面
- ✅ 右側 "Online Users" 顯示「測試小新」
- ✅ 側邊欄顯示「嗨！測試小新」
- ✅ 顯示上傳的頭像

#### 檢查 Firebase：
- **Authentication**: 確認有新用戶 `newuser@test.com`
- **Firestore userdojo**: 確認有新文件包含：
  - `displayName`: "測試小新"
  - `email`: "newuser@test.com"
  - `photoURL`: Firebase Storage 網址
  - `online`: true
- **Storage**: 確認圖片已上傳到 `thumbnails/{uid}/...`

---

### 2️⃣ 登入/登出測試

**目的**: 測試登入登出及線上狀態更新

#### 測試步驟 A - 登入：
1. 如果已登入，先登出
2. 使用 `mtc@123.com` / `123456` 登入

#### 預期結果：
- ✅ 登入成功
- ✅ 顯示「嗨！大明」
- ✅ "Online Users" 中大明旁邊有綠點（線上狀態）
- ✅ 可以看到所有專案

#### 測試步驟 B - 登出：
1. 點擊 "Logout" 按鈕
2. 確認導向登入頁面

#### 預期結果：
- ✅ 登出成功
- ✅ 導向 `/login` 頁面
- ✅ 無法存取 Dashboard (會被導回登入頁)

#### 檢查 Firebase：
- **Firestore userdojo**: 大明的 `online` 變成 `false`

---

### 3️⃣ 多重使用者同時在線測試

**目的**: 測試多個使用者同時在線顯示

#### 測試步驟：
1. **瀏覽器 1**: 使用 `mtc@123.com` 登入
2. **瀏覽器 2** (無痕模式): 使用 `test@123.com` 登入
3. **瀏覽器 3** (無痕模式): 使用 `123@123.com` 登入

#### 預期結果：
- ✅ 所有瀏覽器都顯示 3 個線上使用者
- ✅ 每個線上使用者旁邊都有綠點
- ✅ 當其中一個登出，其他瀏覽器的綠點會消失（需重新整理或即時更新）

---

### 4️⃣ 建立新專案測試

**目的**: 測試建立專案功能

#### 測試步驟：
1. 登入任一帳號 (例如 `mtc@123.com`)
2. 點擊 "New Project" 或前往 `/create`
3. 填寫資料：
   - Project name: `測試專案 - UI 改版`
   - Project details: `改善使用者介面，提升使用體驗`
   - Due date: 選擇未來的日期
   - Category: 選擇 "Design"
   - Assign to: 選擇 1-2 位使用者
4. 點擊 "Add Project"

#### 預期結果：
- ✅ 專案建立成功
- ✅ 導向 Dashboard
- ✅ Dashboard 顯示新建立的專案
- ✅ 專案卡片顯示正確的資訊

#### 檢查 Firebase：
- **Firestore projects**: 確認新文件包含：
  - `name`: "測試專案 - UI 改版"
  - `details`: 詳細描述
  - `category`: "design"
  - `dueDate`: Timestamp
  - `assignedUsersList`: 分配的使用者陣列
  - `createdBy`: 建立者資訊
  - `comments`: 空陣列 []
  - `createdAt`: Timestamp

---

### 5️⃣ 專案篩選測試

**目的**: 測試 Dashboard 的篩選功能

#### 測試步驟：
1. 登入並前往 Dashboard
2. 測試以下篩選選項：
   - 點擊 "All" - 顯示所有專案
   - 點擊 "Mine" - 只顯示分配給我的專案
   - 點擊 "Development" - 只顯示開發類專案
   - 點擊 "Design" - 只顯示設計類專案
   - 點擊 "Sales" - 只顯示業務類專案
   - 點擊 "Marketing" - 只顯示行銷類專案

#### 預期結果：
- ✅ 每個篩選都正確顯示對應的專案
- ✅ "Mine" 只顯示 `assignedUsersList` 包含當前使用者的專案

---

### 6️⃣ 查看專案詳情測試

**目的**: 測試專案詳情頁面

#### 測試步驟：
1. 在 Dashboard 點擊任一專案
2. 查看專案詳情頁面

#### 預期結果：
- ✅ 顯示專案名稱
- ✅ 顯示專案描述
- ✅ 顯示截止日期
- ✅ 顯示分配的使用者（含頭像）
- ✅ 顯示建立者
- ✅ 顯示評論區
- ✅ 有刪除按鈕（如果是建立者）

---

### 7️⃣ 新增專案評論測試 (重點！)

**目的**: 測試專案評論功能（類似聊天）

#### 測試步驟：
1. **瀏覽器 1**: 使用 `mtc@123.com` 登入
2. 點擊「電商平台開發」專案
3. 在 "Add new comment" 輸入：`大家好，這個專案進度如何？`
4. 點擊 "Add Comment"
5. **瀏覽器 2**: 使用 `test@123.com` 登入
6. 點擊同一個專案
7. 新增評論：`進度順利！預計下週完成設計稿`
8. **回到瀏覽器 1**: 重新整理頁面

#### 預期結果：
- ✅ 評論立即顯示
- ✅ 顯示評論者的頭像
- ✅ 顯示評論者的名字
- ✅ 顯示評論內容
- ✅ 顯示評論時間（例如: "2 minutes ago"）
- ✅ 評論按時間順序排列
- ✅ 重新整理後評論依然存在

#### 檢查 Firebase：
- **Firestore projects**: 專案的 `comments` 陣列包含新評論：
  ```
  {
    displayName: "大明",
    photoURL: "...",
    content: "大家好，這個專案進度如何？",
    createdAt: Timestamp,
    id: random number
  }
  ```

---

### 8️⃣ 多人同時評論測試

**目的**: 測試多人即時評論

#### 測試步驟：
1. 開啟 3 個瀏覽器視窗
2. 分別登入 3 個不同帳號
3. 都進入同一個專案
4. 依序新增評論：
   - 大明: `我負責前端開發`
   - 小華: `我負責 UI 設計`
   - 阿強: `我負責後端 API`
5. 每個瀏覽器重新整理

#### 預期結果：
- ✅ 所有評論都正確儲存
- ✅ 每個瀏覽器都能看到 3 則評論
- ✅ 評論順序正確
- ✅ 每個評論顯示正確的作者和頭像

---

### 9️⃣ 刪除專案測試

**目的**: 測試刪除專案功能

#### 測試步驟：
1. 使用建立專案的帳號登入
2. 進入該專案詳情頁
3. 點擊 "Mark as Complete" 或刪除按鈕
4. 確認刪除

#### 預期結果：
- ✅ 專案被刪除
- ✅ 導向 Dashboard
- ✅ 專案不再顯示在列表中

#### 檢查 Firebase：
- **Firestore projects**: 該專案文件已被刪除

---

### 🔟 線上使用者顯示測試

**目的**: 測試線上使用者即時顯示

#### 測試步驟：
1. 登入後查看右側 "All Users" 區域
2. 確認每個使用者顯示：
   - 頭像
   - 名字
   - 線上狀態（綠點）

#### 預期結果：
- ✅ 顯示所有 userdojo 集合中的使用者
- ✅ 線上使用者有綠點標記
- ✅ 離線使用者沒有綠點

---

## 🐛 常見問題檢查

### 問題 1: 登入後顯示錯誤的名字
- **原因**: Firebase Auth 的 displayName 和 Firestore 不一致
- **解決**: 重新執行 `node seedData.js` 更新資料

### 問題 2: 圖片無法上傳
- **檢查**: 圖片是否 < 100kb
- **檢查**: Firebase Storage 規則是否正確

### 問題 3: 評論沒有顯示
- **檢查**: `comments` 欄位是否為陣列
- **檢查**: Firestore 規則是否允許讀取

### 問題 4: 線上狀態不更新
- **原因**: Firestore 即時更新可能有延遲
- **解決**: 重新整理頁面

---

## ✅ 測試檢查表

完成測試後，確認以下項目：

- [ ] 新使用者可以成功註冊
- [ ] 註冊時圖片正確上傳到 Storage
- [ ] userdojo 集合包含所有必要欄位（displayName, email, photoURL, online）
- [ ] 登入/登出功能正常
- [ ] 線上狀態正確更新
- [ ] 可以建立新專案
- [ ] 專案篩選功能正常
- [ ] 可以查看專案詳情
- [ ] 可以新增專案評論
- [ ] 評論顯示作者、時間、內容
- [ ] 多人評論功能正常
- [ ] 可以刪除專案
- [ ] 線上使用者列表正確顯示

---

## 🎯 測試重點總結

### 必須測試的核心功能：
1. **註冊** → 確保 email、displayName、photoURL 都正確儲存
2. **評論（聊天）** → 這是主要的互動功能
3. **線上狀態** → 確保多人協作時能看到誰在線上
4. **專案管理** → 建立、查看、刪除專案

祝測試順利！如果遇到任何問題，告訴我！
